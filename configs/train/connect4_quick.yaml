# Connect4 Quick Training Configuration
# ======================================
# Fast training for testing the pipeline
# Connect4 is more complex than TicTacToe, so even "quick" takes longer

game: connect4

algorithm:
  name: alphazero

  # Hardware device - update based on your system
  device: mps  # Options: 'cpu', 'cuda' (NVIDIA GPU), 'mps' (Apple Silicon)

  # Model architecture
  model:
    class: Connect4MLPNet
    hidden: 128  # Larger than TicTacToe due to bigger state space

  # Training loop
  iterations: 50                     # Reduced for quick testing
  games_per_iteration: 4             # Fewer games (Connect4 is slower)
  batch_size: 64                     # Training batch size
  train_steps_per_iteration: 50      # Gradient steps per iteration
  lr: 0.003                          # Learning rate
  weight_decay: 0.0001               # L2 regularization
  value_loss_coef: 1.0               # Weight for value loss

  # Self-play behavior
  temp_moves: 10                     # More exploration moves than TicTacToe
  tau: 1.0                           # Temperature for exploration
  deterministic_after_temp: true     # Use argmax after temp_moves
  add_dirichlet_noise: true          # Add root noise for exploration

  # MCTS search
  num_sims: 50                       # MCTS simulations per move
  c_puct: 1.25                       # PUCT exploration constant
  dirichlet_alpha: 0.3               # Lower alpha for Connect4 (more actions)
  dirichlet_eps: 0.2                 # Dirichlet noise weight
  illegal_action_penalty: 1000000000.0

  # Experience buffer
  buffer_capacity: 40000             # Max samples in replay buffer
  clear_mcts_each_game: true         # Clear search tree between games

# Notes:
# ------
# - This config is for QUICK TESTING, not production training
# - Connect4 requires more compute than TicTacToe
# - Agent will be weak but training completes reasonably fast
# - For competitive agent, use connect4_full.yaml instead
# - Trained model will be saved to saved_agents/
